<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Ataque CSRF (Agora Bloqueado)</title>
  </head>
  <body>
    <h1>üö® Tentativa de Ataque CSRF</h1>
    <p><strong>ATEN√á√ÉO:</strong> Este ataque agora ser√° BLOQUEADO pela prote√ß√£o CSRF!</p>
    
    <h2>Cen√°rio: Link Malicioso</h2>
    <p>Antes: Usu√°rio clicava no link e um contato era adicionado sem permiss√£o.</p>
    <p>Agora: A rota /contact est√° protegida e requer token CSRF.</p>
    
    <!-- Este formul√°rio tentar√° atacar a rota protegida -->
    <form action="http://vitima.local:3001/contact" method="POST">
      <input type="hidden" name="name" value="Atacante Malicioso" />
      <input type="hidden" name="phone" value="666999888" />
      <button type="submit" style="background: red; color: white; padding: 10px;">
        üéØ Tentar Ataque (Ser√° Bloqueado)
      </button>
    </form>
    
    <script>
      // Tentar ataque autom√°tico via JavaScript tamb√©m
      setTimeout(async () => {
        try {
          const response = await fetch("http://vitima.local:3001/contact", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            credentials: "include",
            body: JSON.stringify({ name: "Atacante JS", phone: "666777888" })
            // SEM token CSRF - ser√° bloqueado
          });
          
          const data = await response.json();
          console.log("Resultado do ataque:", data);
          
          if (!response.ok) {
            document.body.innerHTML += `
              <div style="background: green; color: white; padding: 10px; margin: 10px;">
                ‚úÖ ATAQUE BLOQUEADO: ${data.error}
              </div>
            `;
          }
        } catch (err) {
          console.log("Ataque falhou:", err);
        }
      }, 1000);
    </script>
  </body>
</html>
